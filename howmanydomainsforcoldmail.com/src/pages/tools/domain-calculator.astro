---
import Base from '../../layouts/Base.astro';
import { siteConfig } from '../../config';

const schema = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Cold Email Domain Calculator",
  "applicationCategory": "BusinessApplication",
  "description": "Calculate exactly how many domains and mailboxes you need based on your target daily volume.",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
};
---

<Base
  title="Cold Email Domain Calculator | How Many Domains for Cold Email"
  description="Free calculator: enter your target daily sending volume and get the exact number of domains, mailboxes, warm-up timeline, and cost estimate."
  schema={schema}
>
  <section class="max-w-3xl mx-auto px-4 sm:px-6 py-12 md:py-20">
    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900">Cold Email Domain Calculator</h1>
    <p class="mt-4 text-lg text-gray-600">
      Enter your target daily volume and sending preferences. We'll calculate exactly how many domains and mailboxes you need.
    </p>

    <div class="mt-10 p-6 border border-gray-200 rounded-lg bg-white">
      <div class="space-y-6">
        <div>
          <label for="daily-volume" class="block text-sm font-medium text-gray-700">Target emails per day</label>
          <input type="number" id="daily-volume" value="500" min="10" max="50000" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg" />
        </div>
        <div>
          <label for="risk-level" class="block text-sm font-medium text-gray-700">Risk tolerance</label>
          <select id="risk-level" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="conservative">Conservative (50/mailbox/day)</option>
            <option value="moderate" selected>Moderate (75/mailbox/day)</option>
            <option value="aggressive">Aggressive (100/mailbox/day)</option>
          </select>
        </div>
        <div>
          <label for="mailboxes-per-domain" class="block text-sm font-medium text-gray-700">Mailboxes per domain</label>
          <select id="mailboxes-per-domain" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="2" selected>2 (recommended)</option>
            <option value="3">3 (higher utilization)</option>
          </select>
        </div>
        <div>
          <label for="include-rotation" class="block text-sm font-medium text-gray-700">Include rotation reserve?</label>
          <select id="include-rotation" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="yes" selected>Yes — add resting & warm-up domains (recommended)</option>
            <option value="no">No — active domains only</option>
          </select>
        </div>
      </div>

      <div id="results" class="mt-8 p-6 bg-gray-50 rounded-lg">
        <h2 class="text-lg font-semibold text-gray-900">Your Domain Infrastructure</h2>
        <div class="mt-4 grid grid-cols-2 sm:grid-cols-3 gap-4">
          <div><p class="text-sm text-gray-500">Active domains</p><p id="active-domains" class="text-3xl font-bold text-gray-900">4</p></div>
          <div><p class="text-sm text-gray-500">Resting domains</p><p id="resting-domains" class="text-3xl font-bold text-gray-900">2</p></div>
          <div><p class="text-sm text-gray-500">Warm-up domains</p><p id="warmup-domains" class="text-3xl font-bold text-gray-900">1</p></div>
          <div><p class="text-sm text-gray-500">Total domains</p><p id="total-domains" class="text-3xl font-bold text-blue-600">7</p></div>
          <div><p class="text-sm text-gray-500">Total mailboxes</p><p id="total-mailboxes" class="text-3xl font-bold text-gray-900">8</p></div>
          <div><p class="text-sm text-gray-500">Sends per mailbox</p><p id="sends-per-mailbox" class="text-3xl font-bold text-gray-900">63</p></div>
        </div>

        <div class="mt-6 p-4 bg-white rounded-md border border-gray-200">
          <h3 class="text-sm font-semibold text-gray-700">Monthly Cost Estimate</h3>
          <div class="mt-2 space-y-1 text-sm text-gray-600">
            <div class="flex justify-between"><span>Domains (<span id="cost-domain-count">7</span> × $1/mo)</span><span id="cost-domains" class="font-medium">$7</span></div>
            <div class="flex justify-between"><span>Mailboxes (<span id="cost-mailbox-count">8</span> × $6/mo)</span><span id="cost-mailboxes" class="font-medium">$48</span></div>
            <div class="flex justify-between"><span>Warm-up (<span id="cost-warmup-count">8</span> × $3/mo)</span><span id="cost-warmup" class="font-medium">$24</span></div>
            <div class="flex justify-between border-t border-gray-200 pt-1 mt-1"><span class="font-semibold">Total monthly</span><span id="cost-total" class="font-bold text-gray-900">$79</span></div>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-8 p-6 border border-blue-200 rounded-lg bg-blue-50">
      <p class="text-sm font-medium text-blue-900">Need help setting up your domains?</p>
      <p class="mt-1 text-sm text-blue-700">
        <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="font-semibold underline">{siteConfig.product.name}</a> automates domain setup, DNS configuration, warm-up, rotation, and sending — all from one dashboard.
      </p>
      <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="mt-3 inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 transition-colors">
        Automate with {siteConfig.product.name} &rarr;
      </a>
    </div>

    <div class="mt-12 prose max-w-none">
      <h2>How This Calculator Works</h2>
      <p>
        The calculator divides your target daily volume by the per-mailbox limit (based on your risk tolerance) to determine total mailboxes needed. It then divides by mailboxes-per-domain to get the active domain count. If rotation reserve is included, it adds resting domains (40% of active count) and warm-up domains (20% of active count) for seamless rotation.
      </p>
      <p>
        The standard recommendation is <strong>2–3 mailboxes per domain</strong> sending <strong>50–75 emails per day each</strong>. This keeps each domain well within safe sending limits while maximizing infrastructure efficiency.
      </p>
    </div>
  </section>
</Base>

<script>
  function calculate() {
    const volume = parseInt((document.getElementById('daily-volume') as HTMLInputElement).value) || 500;
    const risk = (document.getElementById('risk-level') as HTMLSelectElement).value;
    const mbPerDomain = parseInt((document.getElementById('mailboxes-per-domain') as HTMLSelectElement).value);
    const includeRotation = (document.getElementById('include-rotation') as HTMLSelectElement).value === 'yes';

    const perMailbox = risk === 'conservative' ? 50 : risk === 'aggressive' ? 100 : 75;
    const totalMailboxes = Math.max(2, Math.ceil(volume / perMailbox));
    const activeDomains = Math.max(2, Math.ceil(totalMailboxes / mbPerDomain));
    const restingDomains = includeRotation ? Math.max(1, Math.ceil(activeDomains * 0.4)) : 0;
    const warmupDomains = includeRotation ? Math.max(1, Math.ceil(activeDomains * 0.2)) : 0;
    const totalDomains = activeDomains + restingDomains + warmupDomains;
    const sendsPerMailbox = Math.round(volume / totalMailboxes);

    document.getElementById('active-domains')!.textContent = String(activeDomains);
    document.getElementById('resting-domains')!.textContent = String(restingDomains);
    document.getElementById('warmup-domains')!.textContent = String(warmupDomains);
    document.getElementById('total-domains')!.textContent = String(totalDomains);
    document.getElementById('total-mailboxes')!.textContent = String(totalMailboxes);
    document.getElementById('sends-per-mailbox')!.textContent = String(sendsPerMailbox);

    // Costs
    const domainCost = totalDomains * 1;
    const mailboxCost = totalMailboxes * 6;
    const warmupCost = totalMailboxes * 3;
    const totalCost = domainCost + mailboxCost + warmupCost;

    document.getElementById('cost-domain-count')!.textContent = String(totalDomains);
    document.getElementById('cost-domains')!.textContent = `$${domainCost}`;
    document.getElementById('cost-mailbox-count')!.textContent = String(totalMailboxes);
    document.getElementById('cost-mailboxes')!.textContent = `$${mailboxCost}`;
    document.getElementById('cost-warmup-count')!.textContent = String(totalMailboxes);
    document.getElementById('cost-warmup')!.textContent = `$${warmupCost}`;
    document.getElementById('cost-total')!.textContent = `$${totalCost}`;
  }

  document.getElementById('daily-volume')?.addEventListener('input', calculate);
  document.getElementById('risk-level')?.addEventListener('change', calculate);
  document.getElementById('mailboxes-per-domain')?.addEventListener('change', calculate);
  document.getElementById('include-rotation')?.addEventListener('change', calculate);
  calculate();
</script>
