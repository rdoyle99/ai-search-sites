---
import Base from '../../layouts/Base.astro';
import { siteConfig } from '../../config';

const schema = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Sponsorship Rate Calculator",
  "applicationCategory": "BusinessApplication",
  "description": "Calculate your sponsorship rate based on audience size, engagement rate, and platform.",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
};
---

<Base
  title="Sponsorship Rate Calculator | Find Sponsorship Opportunities"
  description="Free calculator: estimate your sponsorship rate based on platform, audience size, engagement rate, and niche."
  schema={schema}
>
  <section class="max-w-3xl mx-auto px-4 sm:px-6 py-12 md:py-20">
    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900">Sponsorship Rate Calculator</h1>
    <p class="mt-4 text-lg text-gray-600">
      Enter your platform, audience size, and engagement metrics to calculate your recommended sponsorship rate.
    </p>

    <div class="mt-10 p-6 border border-gray-200 rounded-lg bg-white">
      <div class="space-y-6">
        <div>
          <label for="platform" class="block text-sm font-medium text-gray-700">Platform</label>
          <select id="platform" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="youtube">YouTube</option>
            <option value="instagram">Instagram</option>
            <option value="tiktok">TikTok</option>
            <option value="podcast">Podcast</option>
            <option value="newsletter">Newsletter</option>
            <option value="twitter">Twitter / X</option>
          </select>
        </div>
        <div>
          <label for="audience-size" class="block text-sm font-medium text-gray-700">
            <span id="audience-label">Subscribers</span>
          </label>
          <input type="number" id="audience-size" value="10000" min="100" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg" />
        </div>
        <div>
          <label for="engagement-rate" class="block text-sm font-medium text-gray-700">Engagement rate (%)</label>
          <input type="number" id="engagement-rate" value="4.0" min="0.1" max="100" step="0.1" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-lg" />
        </div>
        <div>
          <label for="niche" class="block text-sm font-medium text-gray-700">Niche / Category</label>
          <select id="niche" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="tech">Tech / SaaS / B2B</option>
            <option value="finance">Finance / Investing</option>
            <option value="business">Business / Entrepreneurship</option>
            <option value="health">Health / Fitness</option>
            <option value="beauty">Beauty / Fashion</option>
            <option value="gaming">Gaming</option>
            <option value="education">Education</option>
            <option value="lifestyle">Lifestyle / General</option>
            <option value="food">Food / Cooking</option>
            <option value="travel">Travel</option>
          </select>
        </div>
      </div>

      <div id="results" class="mt-8 p-6 bg-gray-50 rounded-lg">
        <h2 class="text-lg font-semibold text-gray-900">Your Estimated Sponsorship Rates</h2>
        <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div class="p-4 bg-white rounded-lg border border-gray-200">
            <p class="text-sm text-gray-500">Single Post / Integration</p>
            <p id="rate-single" class="text-3xl font-bold text-gray-900">$500</p>
            <p class="text-xs text-gray-400 mt-1">One-time deliverable</p>
          </div>
          <div class="p-4 bg-white rounded-lg border border-gray-200">
            <p class="text-sm text-gray-500">Dedicated Content</p>
            <p id="rate-dedicated" class="text-3xl font-bold text-gray-900">$1,250</p>
            <p class="text-xs text-gray-400 mt-1">Full video / episode / issue</p>
          </div>
          <div class="p-4 bg-white rounded-lg border border-gray-200">
            <p class="text-sm text-gray-500">Monthly Package (4 posts)</p>
            <p id="rate-monthly" class="text-3xl font-bold text-gray-900">$1,800</p>
            <p class="text-xs text-gray-400 mt-1">10% ongoing discount applied</p>
          </div>
          <div class="p-4 bg-white rounded-lg border border-gray-200">
            <p class="text-sm text-gray-500">Your CPM</p>
            <p id="rate-cpm" class="text-3xl font-bold text-gray-900">$25</p>
            <p class="text-xs text-gray-400 mt-1">Cost per 1,000 impressions</p>
          </div>
        </div>

        <div class="mt-4 p-3 bg-blue-50 rounded-lg">
          <p id="rate-context" class="text-sm text-blue-800"></p>
        </div>
      </div>
    </div>

    <div class="mt-8 p-6 border border-blue-200 rounded-lg bg-blue-50">
      <p class="text-sm font-medium text-blue-900">Ready to pitch brands?</p>
      <p class="mt-1 text-sm text-blue-700">
        <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="font-semibold underline">{siteConfig.product.name}</a> helps creators send personalized sponsorship pitch emails at scale with automated follow-ups.
      </p>
      <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="mt-3 inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 transition-colors">
        Pitch with {siteConfig.product.name} &rarr;
      </a>
    </div>

    <div class="mt-12 prose max-w-none">
      <h2>How This Calculator Works</h2>
      <p>
        The calculator estimates your sponsorship rate using three factors: <strong>audience size</strong> (reach), <strong>engagement rate</strong> (audience quality), and <strong>niche multiplier</strong> (advertiser demand for your audience segment). B2B and finance niches command 2–3x higher CPMs than lifestyle and entertainment because each viewer has higher purchasing power.
      </p>
      <p>
        Rates are estimates based on industry benchmarks from 2026. Your actual rate may be higher or lower depending on content quality, past brand partnerships, audience demographics, and negotiation skills.
      </p>
    </div>
  </section>
</Base>

<script>
  const platformConfig: Record<string, { baseCPM: number; label: string; dedicatedMultiplier: number }> = {
    youtube: { baseCPM: 20, label: 'Subscribers', dedicatedMultiplier: 2.5 },
    instagram: { baseCPM: 10, label: 'Followers', dedicatedMultiplier: 2.0 },
    tiktok: { baseCPM: 8, label: 'Followers', dedicatedMultiplier: 2.0 },
    podcast: { baseCPM: 25, label: 'Downloads per episode', dedicatedMultiplier: 3.0 },
    newsletter: { baseCPM: 30, label: 'Subscribers', dedicatedMultiplier: 2.0 },
    twitter: { baseCPM: 5, label: 'Followers', dedicatedMultiplier: 2.0 },
  };

  const nicheMultipliers: Record<string, number> = {
    tech: 2.2,
    finance: 2.5,
    business: 2.0,
    health: 1.3,
    beauty: 1.1,
    gaming: 0.8,
    education: 1.5,
    lifestyle: 1.0,
    food: 1.0,
    travel: 1.2,
  };

  function calculate() {
    const platform = (document.getElementById('platform') as HTMLSelectElement).value;
    const audience = parseInt((document.getElementById('audience-size') as HTMLInputElement).value) || 10000;
    const engagement = parseFloat((document.getElementById('engagement-rate') as HTMLInputElement).value) || 4.0;
    const niche = (document.getElementById('niche') as HTMLSelectElement).value;

    const config = platformConfig[platform];
    const nicheMultiplier = nicheMultipliers[niche];

    // Engagement multiplier: above 5% gets bonus, below 2% gets penalty
    const engagementMultiplier = engagement >= 5 ? 1.3 : engagement >= 3 ? 1.0 : engagement >= 1 ? 0.7 : 0.5;

    const effectiveCPM = config.baseCPM * nicheMultiplier * engagementMultiplier;
    const estimatedReach = audience * (engagement / 100) * 10; // rough estimated impressions
    const impressions = Math.max(audience * 0.3, estimatedReach); // at least 30% of audience

    const singleRate = Math.round((impressions / 1000) * effectiveCPM);
    const dedicatedRate = Math.round(singleRate * config.dedicatedMultiplier);
    const monthlyRate = Math.round(singleRate * 4 * 0.9); // 4 posts, 10% discount

    document.getElementById('rate-single')!.textContent = `$${singleRate.toLocaleString()}`;
    document.getElementById('rate-dedicated')!.textContent = `$${dedicatedRate.toLocaleString()}`;
    document.getElementById('rate-monthly')!.textContent = `$${monthlyRate.toLocaleString()}`;
    document.getElementById('rate-cpm')!.textContent = `$${Math.round(effectiveCPM)}`;

    const tier = singleRate < 200 ? 'nano-influencer' : singleRate < 1000 ? 'micro-influencer' : singleRate < 5000 ? 'mid-tier creator' : 'established creator';
    document.getElementById('rate-context')!.textContent = `Based on your metrics, you're in the ${tier} range. ${engagement >= 5 ? 'Your high engagement rate commands premium rates.' : engagement >= 3 ? 'Solid engagement — focus on growing audience for higher rates.' : 'Consider improving engagement to command better rates.'}`;

    document.getElementById('audience-label')!.textContent = config.label;
  }

  document.getElementById('platform')?.addEventListener('change', calculate);
  document.getElementById('audience-size')?.addEventListener('input', calculate);
  document.getElementById('engagement-rate')?.addEventListener('input', calculate);
  document.getElementById('niche')?.addEventListener('change', calculate);
  calculate();
</script>
