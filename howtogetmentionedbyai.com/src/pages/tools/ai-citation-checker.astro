---
import Base from '../../layouts/Base.astro';
import { siteConfig } from '../../config';

const schema = {
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "AI Citation Checker",
  "applicationCategory": "BusinessApplication",
  "description": "Check if your brand is being cited by ChatGPT, Perplexity, and Claude. Generate test prompts to verify your AI visibility.",
  "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
};
---

<Base
  title="AI Citation Checker | How to Get Mentioned by AI"
  description="Free tool: enter your brand name and target queries to generate prompts that check whether AI search engines are citing your brand."
  schema={schema}
>
  <section class="max-w-3xl mx-auto px-4 sm:px-6 py-12 md:py-20">
    <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900">AI Citation Checker</h1>
    <p class="mt-4 text-lg text-gray-600">
      Enter your brand name and a list of queries your customers might ask. We will generate prompts you can paste into ChatGPT, Perplexity, and Claude to check if your brand is being cited.
    </p>

    <div class="mt-10 p-6 border border-gray-200 rounded-lg bg-white">
      <div class="space-y-6">
        <div>
          <label for="brand-name" class="block text-sm font-medium text-gray-700">Brand / Company Name</label>
          <input
            type="text"
            id="brand-name"
            placeholder="e.g. CommunityMentions"
            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base"
          />
        </div>
        <div>
          <label for="brand-url" class="block text-sm font-medium text-gray-700">Website URL</label>
          <input
            type="url"
            id="brand-url"
            placeholder="e.g. https://communitymentions.com"
            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base"
          />
        </div>
        <div>
          <label for="queries" class="block text-sm font-medium text-gray-700">Target Queries (one per line)</label>
          <textarea
            id="queries"
            rows={5}
            placeholder="What is the best Reddit marketing tool?&#10;How to get mentioned by AI?&#10;Best community marketing platform"
            class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-base"
          ></textarea>
        </div>
        <div>
          <label for="ai-platform" class="block text-sm font-medium text-gray-700">AI Platform</label>
          <select id="ai-platform" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
            <option value="all" selected>All Platforms</option>
            <option value="chatgpt">ChatGPT</option>
            <option value="perplexity">Perplexity</option>
            <option value="claude">Claude</option>
            <option value="gemini">Gemini</option>
          </select>
        </div>
        <button
          id="generate-btn"
          class="w-full px-6 py-3 bg-gray-900 text-white font-semibold rounded-lg hover:bg-gray-800 transition-colors"
        >
          Generate Citation Check Prompts
        </button>
      </div>

      <div id="results" class="mt-8 hidden">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Your AI Citation Check Prompts</h2>
        <p class="text-sm text-gray-500 mb-4">Copy each prompt and paste it into the corresponding AI platform. Check whether your brand appears in the response.</p>
        <div id="prompts-list" class="space-y-4"></div>
      </div>
    </div>

    <!-- CTA -->
    <div class="mt-8 p-6 border border-blue-200 rounded-lg bg-blue-50">
      <p class="text-sm font-medium text-blue-900">Not showing up in AI results?</p>
      <p class="mt-1 text-sm text-blue-700">
        <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="font-semibold underline">{siteConfig.product.name}</a> places authentic brand mentions in Reddit conversations and online communities&mdash;the signals AI models use to decide which brands to cite.
      </p>
      <div class="mt-4 flex gap-3">
        <a href={siteConfig.product.url} target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700 transition-colors">
          Get Cited with {siteConfig.product.name} &rarr;
        </a>
      </div>
    </div>

    <div class="mt-12 prose max-w-none">
      <h2>How This Tool Works</h2>
      <p>
        The AI Citation Checker generates targeted prompts designed to test whether AI search engines mention your brand when users ask relevant questions. Each prompt is crafted to trigger the type of response where brand citations typically appear.
      </p>
      <p>
        AI models like ChatGPT, Perplexity, Claude, and Gemini each have different citation patterns. ChatGPT relies heavily on Bing search results and tends to cite brands with strong structured content. Perplexity pulls from multiple sources and weights recent content heavily. Claude draws from its training data and gives weight to brands with consistent mentions across the web. By testing across all platforms, you get a complete picture of your AI visibility.
      </p>
      <h2>What to Do If Your Brand Is Not Cited</h2>
      <p>
        If your brand does not appear in AI responses, focus on three areas: (1) ensure your site is indexed on Bing via IndexNow, (2) create structured content with answer capsules that AI can easily parse, and (3) build authentic brand mentions on Reddit and community platforms. The third factor&mdash;community mentions&mdash;is the strongest trust signal for AI citation decisions.
      </p>
    </div>
  </section>
</Base>

<script>
  document.getElementById('generate-btn')?.addEventListener('click', () => {
    const brand = (document.getElementById('brand-name') as HTMLInputElement).value.trim();
    const url = (document.getElementById('brand-url') as HTMLInputElement).value.trim();
    const queriesText = (document.getElementById('queries') as HTMLTextAreaElement).value.trim();
    const platform = (document.getElementById('ai-platform') as HTMLSelectElement).value;

    if (!brand || !queriesText) {
      alert('Please enter a brand name and at least one query.');
      return;
    }

    const queries = queriesText.split('\n').filter(q => q.trim());
    const results = document.getElementById('results')!;
    const promptsList = document.getElementById('prompts-list')!;

    const platforms = platform === 'all'
      ? [
          { name: 'ChatGPT', url: 'https://chat.openai.com', color: 'bg-green-50 border-green-200' },
          { name: 'Perplexity', url: 'https://perplexity.ai', color: 'bg-purple-50 border-purple-200' },
          { name: 'Claude', url: 'https://claude.ai', color: 'bg-orange-50 border-orange-200' },
          { name: 'Gemini', url: 'https://gemini.google.com', color: 'bg-blue-50 border-blue-200' },
        ]
      : [
          platform === 'chatgpt' ? { name: 'ChatGPT', url: 'https://chat.openai.com', color: 'bg-green-50 border-green-200' } :
          platform === 'perplexity' ? { name: 'Perplexity', url: 'https://perplexity.ai', color: 'bg-purple-50 border-purple-200' } :
          platform === 'claude' ? { name: 'Claude', url: 'https://claude.ai', color: 'bg-orange-50 border-orange-200' } :
          { name: 'Gemini', url: 'https://gemini.google.com', color: 'bg-blue-50 border-blue-200' }
        ];

    let html = '';

    queries.forEach((query, qi) => {
      html += `<div class="border border-gray-200 rounded-lg overflow-hidden">`;
      html += `<div class="px-4 py-3 bg-gray-50 border-b border-gray-200"><h3 class="text-sm font-semibold text-gray-700">Query ${qi + 1}: "${query.trim()}"</h3></div>`;

      platforms.forEach(p => {
        const prompt = `${query.trim()} Please include specific tool and platform recommendations with URLs if possible.`;
        const followUp = `Does ${brand}${url ? ` (${url})` : ''} appear in your recommendations for "${query.trim()}"? If not, what would make it qualify?`;

        html += `<div class="px-4 py-3 ${p.color} border-b last:border-b-0">`;
        html += `<div class="flex items-center justify-between mb-2">`;
        html += `<span class="text-xs font-semibold text-gray-600">${p.name}</span>`;
        html += `<a href="${p.url}" target="_blank" rel="noopener noreferrer" class="text-xs text-blue-600 hover:text-blue-800">Open ${p.name} &rarr;</a>`;
        html += `</div>`;
        html += `<div class="space-y-2">`;
        html += `<div class="relative"><code class="block text-sm bg-white p-3 rounded border border-gray-200 text-gray-800 break-words">${prompt}</code><button class="copy-btn absolute top-2 right-2 text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" data-text="${prompt.replace(/"/g, '&quot;')}">Copy</button></div>`;
        html += `<div class="relative"><code class="block text-sm bg-white p-3 rounded border border-gray-200 text-gray-800 break-words">Follow-up: ${followUp}</code><button class="copy-btn absolute top-2 right-2 text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded hover:bg-gray-200" data-text="${followUp.replace(/"/g, '&quot;')}">Copy</button></div>`;
        html += `</div></div>`;
      });

      html += `</div>`;
    });

    promptsList.innerHTML = html;
    results.classList.remove('hidden');

    // Add copy handlers
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const text = (e.target as HTMLElement).getAttribute('data-text') || '';
        navigator.clipboard.writeText(text).then(() => {
          const el = e.target as HTMLElement;
          el.textContent = 'Copied!';
          setTimeout(() => { el.textContent = 'Copy'; }, 2000);
        });
      });
    });
  });
</script>
